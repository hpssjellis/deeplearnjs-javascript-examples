<script src="https://unpkg.com/deeplearn@0.5.0/dist/deeplearn.js"> </script> 

<script>
// Class myTensor.htmlPrint parameters    
    
// myDiv : HTML div tag id to put table or textarea into, 
// myTitle : optional string table title. Default no title, 
// myTableBoolean : optional boolean true print as a table, false print flattened in a textarea. Default true,
// myFixedDecimal : optiona  integer print to fixed decimal places Default -1 no effect. 
// myConsoleBoolean : optional print the HTML to the console. Default false  
        
class myTensor extends dl.Tensor {
    async htmlPrint(myDiv, myTitle='', myTableBoolean=true, myFixedDecimal=-1, myConsoleBoolean = false)  {
    
    // Matricies with a shape of 1 messes up the chart
    var myRealRank = 0
    for (var myRank=0; myRank <= this.rank-1; myRank++){
       if (this.shape[myRank] != 1){myRealRank += 1}
       //console.log(myRank+', '+this.shape[myRank]+', '+myRealRank)
    }
    
           
       document.getElementById(myDiv).innerHTML = '<b>'+myTitle + '</b><br>'
       const myOutput =  await this.data()

       
       
       if (myTableBoolean){           
          var myTotalOutput = ''
          var myCount = 0
          var my1dEnd = parseInt(this.shape[0])
          var myRowEnd   = parseInt(this.shape[1])
          var myChartEnd = parseInt(this.shape[0])*parseInt(this.shape[1])
          var my3dEnd = parseInt(this.shape[0]) * parseInt(this.shape[1]) * parseInt(this.shape[2])
          var my4dEnd = parseInt(this.shape[0]) * parseInt(this.shape[1]) * parseInt(this.shape[2])* parseInt(this.shape[3])

          // console.log(myRowEnd+', '+myChartEnd+', '+my3dEnd+', '+my4dEnd)

          if (myRealRank==1){
             if (myConsoleBoolean){
                console.log('Rank = 1')
              }  
              myCount = 0;
              var myTemp = '<table border=1>\n<tr>'
              for (var myLoop=0; myLoop <= this.size-1; myLoop++){
                  myCount += 1
                  if (myFixedDecimal >=0){
                     myTemp +=  '<td title='+myLoop+'>'+myOutput[myLoop].toFixed(myFixedDecimal) +'</td>'
                  } else {
                     myTemp +=  '<td title='+myLoop+'>'+myOutput[myLoop] +'</td>'
                  }  
                  if (myCount == my1dEnd){
                     myTemp += '</tr>\n</table>'
                  }                         
               }
              if (myConsoleBoolean ){
                 console.log(myTemp)
              }
              document.getElementById(myDiv).innerHTML += myTemp + '<br>'
            }
           



          if (myRealRank==2){
             if (myConsoleBoolean){
                console.log('Rank = 2')
              }  
              myCount = 0;
//console.log(myFixedDecimal)
              var myTemp = '<table border=1>\n<tr>'
              for (var myLoop=0; myLoop <= this.size-1; myLoop++){
                  myCount +=1
                  if (myFixedDecimal >=0){
                     myTemp +=  '<td title='+myLoop+'>'+myOutput[myLoop].toFixed(myFixedDecimal) +'</td>'
                  } else {
                     myTemp +=  '<td title='+myLoop+'>'+myOutput[myLoop] +'</td>'
                  } 
                  if(myCount % myRowEnd == 0){
                     if (myCount == myChartEnd){
                        myTemp += '</tr>\n</table>'
                     } else {
                        myTemp +=  '</tr>\n<tr>' 
                     } 
                  }              
               }
              if (myConsoleBoolean ){
                 console.log(myTemp)
              }
              document.getElementById(myDiv).innerHTML += myTemp + '<br>'
            }
           



          if (myRealRank==3){
             if (myConsoleBoolean){
                console.log('Rank = 3')
              }  
              myCount = 0;

              var myTemp = '<table border=1>\n<tr><td>\n<table border=1 width="100%">\n<tr>'
              for (var myLoop=0; myLoop <= this.size-1; myLoop++){
                  myCount +=1
                  if (myFixedDecimal >=0){
                     myTemp +=  '<td>'+myOutput[myLoop].toFixed(myFixedDecimal) +'</td>'
                  } else {
                     myTemp +=  '<td>'+myOutput[myLoop] +'</td>'
                  } 
                if (myCount % my3dEnd==0){
                     myTemp += '</tr>\n</table>\n</td></tr>\n</table>\n'
                } else {
                     if(myCount % myRowEnd == 0){
                        if (myCount % myChartEnd == 0){
                           myTemp += '</tr>\n</table>\n</td><td>\n<table border=1 width="100%">\n'
                        } else {
                           myTemp +=  '</tr>\n<tr>' 
                       } 
                    } 
                 }             
               }
              if (myConsoleBoolean ){
                 console.log(myTemp)
              }
              document.getElementById(myDiv).innerHTML += myTemp + '<br>'
            }
             
   





          if (myRealRank==4){
             if (myConsoleBoolean){
                console.log('Rank = 4')
              }  
              myCount = 0;

              var myTemp = '<table border=1>\n<tr><td>\n<table border=1 width="100%">\n<tr>'
              for (var myLoop=0; myLoop <= this.size-1; myLoop++){
                  myCount +=1
                  if (myFixedDecimal >=0){
                     myTemp +=  '<td>'+myOutput[myLoop].toFixed(myFixedDecimal) +'</td>'
                  } else {
                     myTemp +=  '<td>'+myOutput[myLoop] +'</td>'
                  } 
 
               
                if (myCount == my4dEnd){
                     myTemp += '</tr>\n</table>\n</td></tr>\n</table>\n'
                } else {
                     if(myCount % myRowEnd == 0){
                        if (myCount % myChartEnd == 0){

                            if(myCount == my3dEnd){ 
                               myTemp += '</tr>\n</table>\n</td></tr>\n<tr><td>\n<table border=1 width="100%">\n<tr>'
                           } else {


                           myTemp += '</tr>\n</table>\n</td><td>\n<table border=1 width="100%">\n'
                        }} else {
                          
                               myTemp +=  '</tr>\n<tr>' 
                          
                       } 
                    } 
                 }             
               }
              if (myConsoleBoolean ){
                 console.log(myTemp)
              }
              document.getElementById(myDiv).innerHTML += myTemp + '<br>'
            }
             


  

          if (myRealRank > 4){
             if (myConsoleBoolean){
                console.log('Rank > 4')
              }             
              myCount = 0;
              var myStartEachLoop = 0
          for (var myBig=0; myBig <= myRealRank-1; myBig++){
             myStartEachLoop = myBig * my4dEnd 

              var myTemp = '<table border=1>\n<tr><td>\n<table border=1 width="100%">\n<tr>'
              for (var myLoop=myStartEachLoop; myLoop <= (((myBig+1) * my4dEnd)-1); myLoop++){

                  myCount +=1
                  if (myFixedDecimal >=0){
                     myTemp +=  '<td>'+myOutput[myLoop].toFixed(myFixedDecimal) +'</td>'
                  } else {
                     myTemp +=  '<td>'+myOutput[myLoop] +'</td>'
                  } 
 
               
                if (myCount % my4dEnd==0){
                     myTemp += '</tr>\n</table>\n</td></tr>\n</table>\n'
                } else {
                     if(myCount % myRowEnd == 0){
                        if (myCount % myChartEnd == 0){

                            if(myCount % my3dEnd==0){ 
                               myTemp += '</tr>\n</table>\n</td></tr>\n<tr><td>\n<table border=1 width="100%">\n<tr>'
                           } else {


                           myTemp += '</tr>\n</table>\n</td><td>\n<table border=1 width="100%">\n'
                        }} else {
                          
                               myTemp +=  '</tr>\n<tr>' 
                          
                       } 
                    } 
                 }             
               }
              if (myConsoleBoolean ){
                 console.log(myTemp)
              }
              document.getElementById(myDiv).innerHTML += myTemp + '<br>'
            }
             
      } // big for loop end


 
          
           
           
       } else {      // end table output start flattened textarea output 
            var myTemp = '<textarea rows=10 cols=70>'
            for (var myCount = 0;    myCount <= this.size - 1;   myCount++){ 
                if (myFixedDecimal >=0){
                   myTemp += myOutput[myCount].toFixed(myFixedDecimal) + ', ' 
                } else {
                    myTemp += myOutput[myCount] +', '
                }     
            } 
            myTemp += '</textarea>'
            document.getElementById(myDiv).innerHTML += myTemp + '<br>'
            if (myConsoleBoolean ){
                 console.log(myTemp)
            }

       }    // end myTableBoolean else
    }       // end htmlPrint
}           // end myTensor class
    
</script>


<input type="button" value="tensor.htmlPrint()" onclick="{
   const myWeights  = new myTensor([2,6,3,2],'float32',[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72]);
   //const myWeights  = new myTensor([2,2],'float32',[1,2,3,4]);
   //myWeights.print()

   myWeights.htmlPrint('myDiv01',  'Weights [2,6,3,2]', true, 3, false)
}"><br>



<div id="myDiv01"></div><br><br><br><br>


Setup Tensor <br>
const myWeights  = new myTensor([<input id="myArg" type=text value="2,2" placeholder="2,2" >],'float32',
[<input id="myFlat" type=text value="1,2,3,4" placeholder="1,2,3,4" >])<br><br> 

Then HTML Print Tensor<br> 

myWeights.htmlPrint('myDiv02',<input id="myTitle2" type=text value="myWeights[2,2]" placeholder="myWeights[2,2]" >
<select id="mySel" size=1><option value=true>true<option value=false>false</select>, 
<select id="myDec" size=1><option value=-1>-1<option value=0>0<option value=1>1<option value=2>2<option value=3>3<option value=4>4<option value=5>5<option value=6>6<option value=7>7<option value=8>8<option value=9>9</select>,
<select id="myShow" size=1><option value=false>false<option value=true>true</select> )<br><br> 


<input type="button" value="tensor.htmlPrint()" onclick="{

   my1 = document.getElementById('myArg').value.split(',').map(Number)
   my2 = 'float32'
   my3 = document.getElementById('myFlat').value.split(',').map(Number)
   my4 = 'myDiv02'
   my5 = document.getElementById('myTitle2').value
   my6 = JSON.parse(document.getElementById('mySel').value)
   my7 = parseInt(document.getElementById('myDec').value)
   my8 = JSON.parse(document.getElementById('myShow').value)

   const myWeights  = new myTensor(my1, my2, my3);
   //myWeights.print()

   myWeights.htmlPrint(my4, my5, my6, my7, my8)

}"><br>




<div id="myDiv02"></div><br>
